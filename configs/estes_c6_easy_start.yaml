# configs/estes_c6_easy_start.yaml
#
# Fixed configuration for tractable training
# Key changes from default:
# 1. Reduced control authority (max_tab_deflection: 5°) - makes random actions less catastrophic
# 2. Higher max_roll_rate termination (720°/s) - episodes survive longer
# 3. Lower initial spin (5°/s std) - easier starting conditions
# 4. Higher damping - helps stabilize
#
# Training strategy:
# 1. Start with this easy config to learn basic control
# 2. Gradually increase difficulty via curriculum or new configs

physics:
  dry_mass: 0.1
  propellant_mass: 0.0123
  diameter: 0.024
  length: 0.4
  num_fins: 4
  fin_span: 0.04
  fin_root_chord: 0.05
  fin_tip_chord: 0.025

  # KEY FIX 1: Reduced control authority
  # Was 15° - random actions added ±100°/s per step
  # Now 5° - random actions add ±33°/s per step
  max_tab_deflection: 5.0

  tab_chord_fraction: 0.25
  tab_span_fraction: 0.5
  cd_body: 0.5
  cd_fins: 0.01
  cl_alpha: 2.0
  control_effectiveness: 1.0

  # Physics tuning (keep the fix)
  disturbance_scale: 0.0001

  # KEY FIX 2: Increased damping helps stabilize
  damping_scale: 2.0

  # KEY FIX 3: Lower initial spin - easier to learn
  initial_spin_std: 5.0

motor:
  name: estes_c6
  thrust_multiplier: 1.0

environment:
  dt: 0.01  # Match RocketConfig default
  max_episode_steps: 500
  initial_spin_rate_range:
  - -15.0
  - 15.0
  initial_tilt_range:
  - -5.0
  - 5.0
  enable_wind: false  # Disable wind initially
  max_wind_speed: 0.0
  max_gust_speed: 0.0
  wind_variability: 0.0

  # KEY FIX 4: Higher termination threshold - episodes survive longer
  max_tilt_angle: 60.0
  min_altitude: -1.0
  max_altitude: 200.0
  normalize_observations: true
  obs_clip_value: 10.0

reward:
  altitude_reward_scale: 0.01
  spin_penalty_scale: -0.05  # Reduced penalty - was -0.1
  low_spin_bonus: 1.0
  low_spin_threshold: 30.0  # More achievable threshold
  control_effort_penalty: -0.005  # Reduced - don't penalize learning to use controls
  control_smoothness_penalty: -0.02  # Reduced
  success_bonus: 100.0
  crash_penalty: -20.0  # Reduced crash penalty
  use_potential_shaping: false
  gamma: 0.99

ppo:
  learning_rate: 0.0003  # Slightly higher LR for faster initial learning
  n_steps: 2048  # More steps per rollout for better gradient estimates
  batch_size: 64
  n_epochs: 10
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2  # Standard clip range
  clip_range_vf: null
  ent_coef: 0.01  # Encourage exploration
  vf_coef: 0.5
  max_grad_norm: 0.5
  normalize_advantage: true
  policy_net_arch:
  - 128
  - 128
  value_net_arch:
  - 128
  - 128
  activation: tanh
  total_timesteps: 500000
  n_envs: 8
  device: auto

curriculum:
  enabled: false  # Can enable later for progressive difficulty
  stages:
  - name: basic
    initial_spin_range:
    - -10
    - 10
    wind_enabled: false
    target_reward: 50
  - name: moderate
    initial_spin_range:
    - -30
    - 30
    wind_enabled: false
    target_reward: 100
  - name: full
    initial_spin_range:
    - -30
    - 30
    wind_enabled: true
    target_reward: 150
  episodes_to_evaluate: 100
  advancement_threshold: 0.8

logging:
  log_dir: logs
  save_dir: models
  tensorboard_log: true
  save_freq: 10000
  keep_checkpoints: 5
  eval_freq: 5000
  n_eval_episodes: 20
  log_episode_freq: 10
  experiment_name: rocket_spin_control_easy
  tags:
  - estes_c6
  - spin_control
  - easy_start
